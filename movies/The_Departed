As a child, Colin Sullivan is introduced to <a href="/wiki/Organized_crime" title="Organized crime">organized crime</a> by Irish-American mobster Frank Costello in the Irish neighborhood of <a href="/wiki/South_Boston" title="South Boston">South Boston</a>. Over the years, Costello grooms him to become a <a href="/wiki/Mole_(espionage)" title="Mole (espionage)">mole</a> inside the <a href="/wiki/Massachusetts_State_Police" title="Massachusetts State Police">Massachusetts State Police</a>. Sullivan is accepted into the Special Investigations Unit, which focuses on organized crime.

Before graduating from the state <a href="/wiki/Police_academy" title="Police academy">police academy</a>, Billy Costigan is recruited by Captain Queenan and Staff Sergeant Dignam to go undercover, as his family ties to organized crime make him a perfect infiltrator. He drops out of the academy and serves time in prison on a fake assault charge to increase his credibility.

Each man infiltrates his respective target organization. Sullivan begins a romance with police psychiatrist Madolyn Madden. Costigan sees her as a condition of his probation, and they begin a relationship, too. After Costello escapes a <a href="/wiki/Sting_operation" title="Sting operation">sting operation</a>, each mole becomes aware of the other's existence. Sullivan is told to find the "<a href="/wiki/Informant" title="Informant">rat</a>" and asks Costello for information to identify the informer.

Costigan follows Costello into a <a href="/wiki/Adult_movie_theater" title="Adult movie theater">porn theater</a>, where Costello gives Sullivan an envelope containing personal information on his crew members. Costigan chases Sullivan through <a href="/wiki/Chinatown" title="Chinatown">Chinatown</a>. When it is over, neither man knows the other's identity. Sullivan has Queenan tailed to a meeting with Costigan on the roof of a warehouse. Queenan orders Costigan to flee while he confronts Costello's men alone. Queenan is tossed off the roof by Costello's henchmen and takes a deadly plunge. When they exit, Costigan pretends he has come to join them. During their escape from the police, crew member Delahunt is shot, and he later dies. Television news states that Delahunt had been an undercover cop, working for the <a href="/wiki/Boston_Police_Department" title="Boston Police Department">Boston Police Department</a>, but Costello does not believe the story. With Queenan's absence, Dignam resigns rather than work with Sullivan, who he suspects is the mole.

Using Queenan's phone, Sullivan reaches Costigan, who refuses to abort his mission. Sullivan learns from Queenan's diary of Costello's role as an informant for the <a href="/wiki/FBI" class="mw-redirect" title="FBI">FBI</a>, causing him to worry about his own identity being revealed. With Costigan's help, Costello is traced to a cocaine drop-off, where a gunfight erupts between Costello's crew and the police. Most of the crew are killed. Costello, confronted by Sullivan, admits he is an FBI informant. Costello tries to shoot Sullivan, but Sullivan shoots him multiple times. With Costello dead, Sullivan is applauded the next day by everyone on the force. In good faith, Costigan comes to Sullivan for restoration of his true identity and to be paid for his work, but notices the envelope from Costello on Sullivan's desk and flees, finally realizing Sullivan is the enemy. Fearing retaliation, Sullivan erases Costigan's records from the police computer system.

Sullivan is unaware that Madolyn had an affair with Costigan when she tells Sullivan that she is pregnant. Later, Sullivan finds her listening to a CD from Costigan containing incriminating recorded conversations between Costello and Sullivan. Sullivan unsuccessfully attempts to assuage her suspicions. He contacts Costigan, who reveals that Costello had recorded each of their conversations, and his attorney arranged for Costigan to take possession of the recordings, and Costigan intends to implicate Sullivan. The two agree to meet at the building where Queenan was killed.

On the roof, Costigan catches Sullivan off-guard and handcuffs him. As Costigan had secretly arranged, Trooper Brown appears on the roof as well. Shocked, Brown draws his gun on Costigan, who attempts to justify his actions by exposing Sullivan as Costello's mole. Costigan asks Brown why Dignam did not accompany him as Costigan had requested, but Brown does not answer. Costigan leads Sullivan, his hostage, to the elevator. When it reaches the ground floor, Trooper Barrigan shoots Costigan in the head, then shoots Brown, and afterward reveals to Sullivan that Costello had more than one mole in the police. Sullivan shoots and kills Barrigan. At state police headquarters, Sullivan identifies Barrigan as the mole and has Costigan posthumously given the Medal of Merit.

At Costigan's funeral, Sullivan notices that Madolyn is tearful. As they leave the gravesite, Sullivan attempts to talk to her, but she ignores him. The film ends with Sullivan returning from the grocery store to his apartment, where he is ambushed by Dignam, who shoots and kills him as he enters.


